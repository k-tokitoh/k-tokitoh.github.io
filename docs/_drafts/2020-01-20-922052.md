---
title: 
tags: 
---
認証について調べたのでメモ。

# 前提

ブラウザでデータを保管する場所はいくつかあり、次の性質で分類できる。

  * リクエストの際にサーバに送信する/しない
  * セッション限りで有効/指定した期限まで有効

まとめると以下。(カッコ内はchromeのdev toolsでの表示位置Z。)

| リクエストの際にサーバに送信する | リクエストの際にサーバに送信しない  
---|---|---  
セッション限りで有効 | session cookie  
(CookiesのExpiresがSessionのやつ) | session storage  
(SessionStorage)  
指定した期限まで有効 | permanent cookie  
(CookiesのExpiresが日付のやつ) | local storage  
(LocalStorage)  
  
# 認証について

いくつかの観点がある。

### stateless / stateful

ログインした後のリクエストで、そのユーザーがログイン済みであることを認証したい。 その方法は2つある。

##### stateful

  * 最初にログインしたときに、「session_id: 999」というのを整理券的なのを発行する。
  * 「session_id: 999においてuser_id: 123がログイン済み」という情報をサーバ側で保持する。
  * ユーザーが後続のリクエストで「session_id: 999」という整理券的なのを添付すると、サーバは保持していた情報を参照して「ああsession id: 999は...user_id: 123さんね、ログイン済みだね」という感じで認証する。 
    * 「セッションに関する情報をサーバがもつ」という意味でstatefulという。
  * 

##### stateless

  * 最初にログインしたときに、「確かにこいつはuser_id: 123としてログイン済みである(印)」という証明書的なものを発行する。これをtokenと呼ぶ。
  * サーバ側では特に情報を保持しない。
  * ユーザーが後続のリクエストで上記の証明書的なのを添付すると、サーバはそれをみて「ああuser_id: 123のユーザーさんでログイン済みなのね」という感じで認証する。
  * 「セッションに関する情報をサーバがもたない」という意味でstatelessという。
  * サーバがいちいち手元の情報を参照しなくていいのでかるい
  * スケールしやすい
  * サーバ側でセッション管理できない